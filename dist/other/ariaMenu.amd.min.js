/*! Copyright (c) 2013 Jan Nicklas Released under MIT license */
(function(){function l(c){function g(){return"ontouchstart"in window||"onmsgesturechange"in window}function h(a,b){this.d=c.extend(this.g,b);this.b=c(a);this.i()}function m(){this.top=this.left=0}function k(a,b,d){clearTimeout(parseInt(c(a).data("am-delay"),10));b&&d&&c(a).data("am-delay",setTimeout(c.proxy(b,a),d))}h.prototype={g:{focusClass:"menuitem-focus",visibleMenuClass:"show-menu",closeDelay:100},a:{k:function(){},l:function(a){var b=c(this).parent().find(">ul>li>a").first();b.length&&(b.focus(),a.preventDefault())},
p:function(){c(this).focus()},o:function(){c(this).is(":focus")&&c(this).blur()},n:function(a){a=a.data.d;k(this);c(this).addClass(a.focusClass).find(">ul").addClass(a.visibleMenuClass)},m:function(a){var b=a.data.d;k(this,function(){c(this).removeClass(b.focusClass).find(">ul").removeClass(b.visibleMenuClass)},b.closeDelay)},j:function(a){var b=a.data;27===a.which?(a.preventDefault(),b.f()):37<=a.which&&40>=a.which&&b.a.e.apply(this,arguments)},e:function(a){var b=a.data,d=c(a.target).closest("li"),
f=d.width(),g=d.height(),h=d.closest("ul"),k=d[0]===this?c():h.closest("li"),n=k.parent(),p=d.find(">ul"),e=new m;e.q(d);39===a.which?e.left+=f:40===a.which?e.top+=g:37===a.which?e.left-=f:e.top-=g;d=c(e.h("li"));f=d.parent()[0]||!1;h[0]===f?b.c(d)&&a.preventDefault():p[0]===f?b.c(d)&&a.preventDefault():n[0]===f&&b.c(k)&&a.preventDefault()}},i:function(){this.r();this.b.on("focusin","li",this,this.a.n).on("focusout","li",this,this.a.m).on("mouseover","a",this,this.a.p).on("mouseout","a",this,this.a.o).on("keydown",
">li",this,this.a.j).on("click","a",this,g()?this.a.l:this.a.k).removeClass("css-fallback").addClass("aria-menu").addClass((g()?"has":"no")+"-touch")},find:function(a){return this.b.find(a)},c:function(a){return 1===a.find(">li>a, >a").filter(":visible:first").focus().length},r:function(){this.b.attr("role","menubar");this.find("li").attr("role","menuitem");this.find("a+ul").each(function(){c(this).prev("a").attr("aria-haspopup","true")})},f:function(){this.b.find(":focus").blur()}};m.prototype={q:function(a){a=
c(a);var b=c(document);c.extend(this,a.offset());this.top+=0.5*a.height()-b.scrollTop();this.left+=0.5*a.width()-b.scrollLeft()},h:function(a){var b=c(document.elementFromPoint(this.left,this.top));a&&(b=b.closest(a));return b}};c.fn.ariaMenu=function(a){return this.each(function(){var b=c(this);b.data("AriaMenu")||b.data("AriaMenu",new h(this,a))})}}"function"===typeof define&&define.amd?define(["jquery"],l):l(jQuery);}());
