/*! Copyright (c) 2013 Jan Nicklas Released under MIT license */
(function(){function k(c){function f(){return"ontouchstart"in window||"onmsgesturechange"in window}function h(a,b){this.d=c.extend(this.g,b);this.b=c(a);this.i()}function l(){this.top=this.left=0}function g(a,b,d){clearTimeout(Number(c(a).data("am-delay")));b&&d&&c(a).data("am-delay",setTimeout(c.proxy(b,a),d))}h.prototype={g:{focusClass:"menuitem-focus",visibleMenuClass:"show-menu",closeDelay:100},a:{k:function(){},l:function(a){c(this).parent().find(">ul").length&&(c(this).focus(),a.preventDefault())},p:function(){c(this).focus()},
o:function(){c(this).is(":focus")&&c(this).blur()},n:function(a){a=a.data.d;g(this);c(this).addClass(a.focusClass).find(">ul").addClass(a.visibleMenuClass)},m:function(a){var b=a.data.d;g(this,function(){c(this).removeClass(b.focusClass).find(">ul").removeClass(b.visibleMenuClass)},b.closeDelay)},j:function(a){var b=a.data;27===a.which?(a.preventDefault(),b.f()):37<=a.which&&40>=a.which&&b.a.e.apply(this,arguments)},e:function(a){var b=a.data,d=c(a.target).closest("li"),f=d.closest("ul"),h=d.find(">ul"),
g=d[0]===this?c():f.closest("li"),m=g.parent(),e=new l;e.q(d);e.r(a.which,d.width(),d.height());d=c(e.h("li"));e=d.parent()[0]||!1;f[0]===e||h[0]===e?b.c(d)&&a.preventDefault():m[0]===e&&b.c(g)&&a.preventDefault()}},i:function(){this.s();this.b.on("focusin","li",this,this.a.n).on("focusout","li",this,this.a.m).on("mouseover","a",this,this.a.p).on("mouseout","a",this,this.a.o).on("keydown",">li",this,this.a.j).on("click","a",this,f()?this.a.l:this.a.k).removeClass("css-fallback").addClass("aria-menu").addClass((f()?
"has":"no")+"-touch")},find:function(a){return this.b.find(a)},c:function(a){return 1===a.find(">li>a, >a").filter(":visible:first").focus().length},s:function(){this.b.attr("role","menubar");this.find("li").attr("role","menuitem");this.find("a+ul").each(function(){c(this).prev("a").attr("aria-haspopup","true")})},f:function(){this.b.find(":focus").blur()}};l.prototype={q:function(a){a=c(a);var b=c(document);c.extend(this,a.offset());this.top+=0.5*a.height()-b.scrollTop();this.left+=0.5*a.width()-
b.scrollLeft()},r:function(a,b,c){37===a||39===a?this.left+=(a-38)*b:this.top+=(a-39)*c},h:function(a){var b=c(document.elementFromPoint(this.left,this.top));a&&(b=b.closest(a));return b}};c.fn.ariaMenu=function(a){return this.each(function(){var b=c(this);b.data("AriaMenu")||b.data("AriaMenu",new h(this,a))})}}"function"===typeof define&&define.amd?define(["jquery"],k):k(jQuery);}());
