(function(c){"function"===typeof define&&define.amd?define(["jquery"],c):c(jQuery)})(function(c){function f(a,b){this.settings=c.extend(this.defaults,b);this.$elem=c(a);this.init()}function g(){this.top=this.left=0}f.prototype={defaults:{focusClass:"menuitem-focus",focusedSubMenuClass:"show-menu",closeDelay:100},events:{listItemMouseOver:function(){c(this).focus()},listItemMouseOut:function(){c(this).is(":focus")&&c(this).blur()},listItemFocus:function(a){a=a.data.settings;c(this).stop().addClass(a.focusClass).find(">ul").addClass(a.focusedSubMenuClass).attr("aria-hidden",
!1)},listItemBlur:function(a){var b=a.data.settings;c(this).stop().delay(b.closeDelay).queue(function(a){c(this).removeClass(b.focusClass).find(">ul").removeClass(b.focusedSubMenuClass).attr("aria-hidden",!0);a()})},keyDown:function(a){var b=a.data;27===a.which?(a.preventDefault(),b.closeMenu()):37<=a.which&&40>=a.which&&b.events.arrowKeyDown.apply(this,arguments)},arrowKeyDown:function(a){var b=c(a.target).closest("li"),d=b.width(),f=b.height(),h=b.closest("ul"),k=b[0]===this?c():h.closest("li"),
m=k.parent(),l=b.find(">ul"),e=new g;e.moveOver(b);39===a.which?e.left+=d:40===a.which?e.top+=f:37===a.which?e.left-=d:e.top-=f;b=c(e.getElementBelowCursor("li"));d=b.parent()[0]||!1;h[0]===d?(b.find(">a").focus(),a.preventDefault()):l[0]===d?(l.find(">li>a").first().focus(),a.preventDefault()):m[0]===d&&(k.find(">a").focus(),a.preventDefault())}},init:function(){this.setAriaRoles();this.$elem.on("focusin","li",this,this.events.listItemFocus).on("focusout","li",this,this.events.listItemBlur).on("mouseover",
"a",this,this.events.listItemMouseOver).on("mouseout","a",this,this.events.listItemMouseOut).on("keydown",">li",this,this.events.keyDown).removeClass("css-fallback").addClass("aria-menu")},find:function(a){return this.$elem.find(a)},setAriaRoles:function(){this.$elem.attr("role","menubar");this.find("li").attr("role","menuitem");this.find("a+ul").attr({"aria-hidden":"true",role:"menu"}).each(function(){c(this).prev("a").attr("aria-haspopup","true")})},closeMenu:function(){this.$elem.find(":focus").blur()}};
g.prototype={moveOver:function(a){a=c(a);var b=c(document);c.extend(this,a.offset());this.top+=0.5*a.height()-b.scrollTop();this.left+=0.5*a.width()-b.scrollLeft()},getElementBelowCursor:function(a){var b=c(document.elementFromPoint(this.left,this.top));a&&!b.is(a)&&(b=b.closest(a));return b||null}};c.fn.ariaMenu=function(a){return this.each(function(){var b=c(this),d=b.data("AriaMenu");d?"string"===typeof a&&(b=Array.prototype.slice.call(arguments,1),d[a].apply(d,b)):b.data("AriaMenu",new f(this,
a))})}});